###############################################################################
### LOGIN TESTS - Test if sessions are created
###############################################################################

### Test 11: ✅ VALID LOGIN (Should create session!)
### Data: alice@company-a.com + correct password
### INSTRUCTIONS: Run Test 1 (register) FIRST, then run this
### EXPECTED: Returns token + sessionID (proves session was created in DB)
POST http://localhost:7070/api/auth/login
Content-Type: application/json

{
  "email": "alice@company-a.com",
  "password":"SecurePass123"
}

### Test 12: ✅ VALID LOGIN (Should create session!)
### Data: bob@company-b.com + correct password
### INSTRUCTIONS: Run Test 2 (register) FIRST, then run this
### EXPECTED: Returns token + sessionID (proves session was created in DB)
POST http://localhost:7070/api/auth/login
Content-Type: application/json

{
  "email": "bob@company-b.com",
  "password": "ProPassword456"
}

### Test 13: ❌ INVALID LOGIN (Wrong password - Should fail)
### EXPECTED: 401 Unauthorized - no session created
POST http://localhost:7070/api/auth/login
Content-Type: application/json

{
  "email": "alice@company-a.com",
  "password": "WrongPassword123"
}

### Test 14: ✅ VERIFY SESSION EXISTS (alice)
### INSTRUCTIONS: Run Test 11 first, copy the token, paste it here
### EXPECTED: 200 OK - confirms token is valid and session exists
POST http://localhost:7070/api/auth/validate
Content-Type: application/json
Authorization: Bearer $2a$10$MQgIWAoAs5QJW0nyaxToOOO/XGqpbe0tbeUIhndG8xSC6I2cCN24i

{}

### Test 15: ✅ VERIFY SESSION EXISTS (bob)
### INSTRUCTIONS: Run Test 12 first, copy the token, paste it here
### EXPECTED: 200 OK - confirms token is valid and session exists
POST http://localhost:7070/api/auth/validate
Content-Type: application/json
Authorization: Bearer YOUR_TOKEN_HERE

{}

### Test 16: ❌ VERIFY INVALID TOKEN FAILS
### INSTRUCTIONS: Use a random/malformed token
### EXPECTED: 401 Unauthorized - session/token invalid
POST http://localhost:7070/api/auth/validate
Content-Type: application/json
Authorization: Bearer invalid.token.here

{}

###############################################################################
### LOGOUT TESTS - Test session deactivation and activity logging
###############################################################################

### Test 17: ✅ LOGOUT - Deactivate session (alice)
### INSTRUCTIONS: 
###   1. Run Test 11 (login) first to get token
###   2. Copy the token and paste it below
###   3. Run this test
### EXPECTED: 200 OK - "Logout successful"
### DATABASE RESULT: 
###   - session.active = false (for alice's session)
###   - activity_log entry created with type=LOGOUT, status=SUCCESS
POST http://localhost:7070/api/auth/logout
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJBbGZyZWRvIEZlcm5hbmRleiIsInN1YiI6ImFsaWNlQGNvbXBhbnktYS5jb20iLCJleHAiOjE3NjQwNTczNTAsImVtYWlsIjoiYWxpY2VAY29tcGFueS1hLmNvbSIsInJvbGVzIjoidXNlciJ9.V0YxLnPtzImoo0s1NjU_ei0r30gxrVgVQ3wf2lgsUw8

{}

### Test 18: ✅ LOGOUT - Deactivate session (bob)
### INSTRUCTIONS: 
###   1. Run Test 12 (login) first to get token
###   2. Copy the token and paste it below
###   3. Run this test
### EXPECTED: 200 OK - "Logout successful"
### DATABASE RESULT: 
###   - session.active = false (for bob's session)
###   - activity_log entry created with type=LOGOUT, status=SUCCESS
POST http://localhost:7070/api/auth/logout
Content-Type: application/json
Authorization: Bearer YOUR_TOKEN_HERE

{}

### Test 19: ✅ VERIFY SESSION IS DEACTIVATED (should fail)
### INSTRUCTIONS: 
###   1. Run Test 17 (logout) first
###   2. Use the SAME token from Test 17
###   3. Run this test
### EXPECTED: 401 Unauthorized - "Session is inactive"
### This proves that deactivated sessions cannot be used
POST http://localhost:7070/api/auth/validate
Content-Type: application/json
Authorization: Bearer YOUR_TOKEN_AFTER_LOGOUT

{}

### Test 20: ❌ LOGOUT - No Authorization Header (should fail)
### EXPECTED: 401 Unauthorized - "Authorization header missing"
POST http://localhost:7070/api/auth/logout
Content-Type: application/json

{}

### Test 21: ❌ LOGOUT - Malformed Authorization Header (should fail)
### EXPECTED: 401 Unauthorized - "Authorization header malformed"
POST http://localhost:7070/api/auth/logout
Content-Type: application/json
Authorization: MalformedHeader invalid.token.here

{}
